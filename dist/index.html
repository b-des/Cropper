<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
          crossorigin="anonymous">

    <link rel="stylesheet" href="styles.min.css">
</head>
<body>
<div id="app" style="width: auto; margin: 0 auto">
    <button class="btn btn-primary" onclick="addPhoto()">Добавить фото</button>
</div>

</body>


<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
<script src="main.js"></script>

<!-- Bootstrap tooltips -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
<script>
    imgs = [
        {url: 'https://images.pexels.com/photos/1236701/pexels-photo-1236701.jpeg'},
        {
            url: 'https://cdn.pixabay.com/photo/2016/11/14/04/45/elephant-1822636__340.jpg',
            thumbnail: 'https://cdn.pixabay.com/photo/2016/11/14/04/45/elephant-1822636__340.jpg',
            params: {
                my_param: 'value of my param'
            }
        },
        {
            url: 'https://assets.macroplant.com/assets/adapter/adapter-icon-hero-3977e6dc1fc7e2e44df058ea75dcbbb299bdf7b7953fccea23b0a0aefbb1958c.png',
            thumbnail: 'https://assets.macroplant.com/assets/adapter/adapter-icon-hero-3977e6dc1fc7e2e44df058ea75dcbbb299bdf7b7953fccea23b0a0aefbb1958c.png',
            params: {
                some_custom_param: 'value of custom param'
            }
        },
        'https://images.pexels.com/photos/556416/pexels-photo-556416.jpeg',
        'https://c4.wallpaperflare.com/wallpaper/410/867/750/vector-forest-sunset-forest-sunset-forest-wallpaper-thumb.jpg',
        'https://rog.asus.com/media/1554200908315.jpg',
        'https://cdn.guidingtech.com/media/assets/2019/07/Best-Star-Wars-HD-and-4K-Wallpapers-for-Phone-and-PC-9.jpg',
        'https://esossl-a.akamaihd.net/assets/img/cms/media/56274c7523aff0fa1744819a554d7af4_the-halls-of-the-colossus_wallpaper-1920x1080.jpg',
        'https://images3.alphacoders.com/675/675273.jpg',
        'https://www.w3schools.com/w3css/img_lights.jpg',
        'http://s2.fotokto.ru/topics/full/11/110164.jpg',
        'https://www.bigstockphoto.com/images/homepage/module-6.jpg',
        'https://cdn.pixabay.com/photo/2018/02/09/21/46/rose-3142529__340.jpg',
    ];

    function addPhoto() {
        c.addPhotos([imgs[Math.floor(Math.random() * ((imgs.length - 1) - 0 + 1) + 0)]])
    }

    let c = new Cropper({
        container: 'app',
        handlerUrl: 'http://localhost:5567',
        dest: ['C:/Node/Cropper/dist', 'uploads/12334'],
        immediate: false,
        itemsPerPage: 10,
        borderWidth: 10,//толщина рамки по умолчанию
        defaultOptions: [
           //  {option_id: 9, option_value_id: 4},
            // {option_id: 10, option_value_id: 2},
            // {option_id: 12, option_value_id: 2}
        ],
        options: [
            {
                "option_id": "9",
                "name": "Формат бумаги",
                "label": "size",
                "option_values": [
                    {
                        "option_value_id": "1",
                        "relation_options": [
                            {
                                "option_id": 10,
                                "option_value_id": [1]
                            },
                            {
                                "option_id": 13,
                                "option_value_id": [1]
                            }
                        ],
                        "name": "A6 (100x100)",
                        "value": [
                            100,
                            100
                        ]
                    },
                    {
                        "option_value_id": "2",
                        "relation_options": [
                            {
                                "option_id": 10,
                                "option_value_id": [1]
                            },
                            {
                                "option_id": 13,
                                "option_value_id": [2]
                            }
                        ],
                        "name": "A5 (20x15)",
                        "value": [
                            20,
                            15
                        ]
                    },
                    {
                        "option_value_id": "3",
                        "relation_options": [
                            {
                                "option_id": 10,
                                "option_value_id": [2]
                            },
                            {
                                "option_id": 13,
                                "option_value_id": [2]
                            }
                        ],
                        "name": "A5 (10x20)",
                        "value": [
                            10,
                            20
                        ]
                    },
                    {
                        "option_value_id": "4",
                        "relation_options": [
                            {
                                "option_id": 10,
                                "option_value_id": [1, 2]
                            },
                            {
                                "option_id": 13,
                                "option_value_id": [1]
                            }
                        ],
                        "name": "A5 (10x10)",
                        "value": [
                            10,
                            10
                        ]
                    }
                ]
            },
            {
                "option_id": "10",
                "name": "Бумага",
                "label": "paper",
                "option_values": [
                    {
                        "option_value_id": "1",
                        "relation_options": [
                            {
                                "option_id": 9,
                                "option_value_id": [1, 2]
                            },
                            {
                                "option_id": 13,
                                "option_value_id": [2]
                            }
                        ],
                        "label": "embossed",
                        "name": "Тиснёная"
                    },
                    {
                        "option_value_id": "2",
                        "relation_options": [
                            {
                                "option_id": 9,
                                "option_value_id": [3, 4]
                            },

                            {
                                "option_id": 13,
                                "option_value_id": [1, 2, 3, 4, 5, 6]
                            }
                        ],
                        "label": "glossy",
                        "name": "Глянцевая"
                    }
                ]
            },
            {
                "option_id": "11",
                "name": "Кадрирование",
                "label": "framing",
                "option_values": [
                    {
                        "option_value_id": 1,
                        "label": "whole",
                        "name": "Кадр целиком"
                    },
                    {
                        "option_value_id": 2,
                        "label": "cropp",
                        "name": "Кадр в обрез"
                    }
                ]
            },
            {
                "option_id": "12",
                "name": "Рамка",
                "label": "border-select",
                "option_values": [
                    {
                        "option_value_id": "1",
                        "label": "black",
                        "name": "Черная"
                    },
                    {
                        "option_value_id": "2",
                        "label": "white",
                        "name": "Белая"
                    },
                    {
                        "option_value_id": "3",
                        "label": "none",
                        "name": "Без рамки"
                    }
                ]
            },
            {
                "option_id": "13",
                "name": "Кастомная опция",
                "label": "option111",
                "option_values": [
                    {
                        "option_value_id": "1",
                        "label": "black",
                        "name": "Опция 1",
                        "relation_options": [
                            {
                                "option_id": 9,
                                "option_value_id": [1, 2, 3, 4]
                            },
                        ]
                    },
                    {
                        "option_value_id": "2",
                        "label": "white",
                        "name": "Опция 2"
                    },
                    {
                        "option_value_id": "3",
                        "label": "none",
                        "name": "Опция 3"
                    }
                ]
            },
        ]
    });

    let items = [];
    for (let i = 0; i <= 50; i++) {
        items.push(imgs[Math.floor(Math.random() * ((imgs.length - 1) - 0 + 1) + 0)]);
    }

    c.addPhotos(items);


    c.onProcessingStart((data) => {
        console.log(data);
    });

   /* c.process([{"border":"#c93333","borderThickness":"29","crop":{"x":"31.34715025906736","y":"28.756476683937827","w":"65.41450777202073","h":"42.61658031088083"},"dest":["C:/Node/Cropper/dist","uploads/12334"],"left":"-121","original":"false","quantity":"1","rotate":"90","size":{"width":"152","height":"102"},"thumbnail":"image\/photobox\/uploads\/tmp\/sisadmin_typical_4aad3e2ff46c64676ace26dacdd3b929-ua28q5t-rotated.png?v=1573655414035","top":"-111","url":"https:\/\/pechat.photo\/image\/customer\/authorized\/d3d9446802a44259755d38e6d163e820\/sisadmin_typical_4aad3e2ff46c64676ace26dacdd3b929.png","zoom":"1.61"}], (res) => {
        console.log(res);
    });*/

    c.onImagesProcessed((items) => {
         c.clear();
        c.addPhotos(items.photos);

    });

    c.onPropertiesChanged(result => {
         console.log("Option changed");
         console.log(result);
    })

</script>
</html>
